<div class="panel panel-default" ng-controller="ProfileController">
    <div class="panel-heading handle bold">
        {{profileWidget.title| translate}}
        <span class="nav-pills" ng-show="selectedTei.attributes.length">
            | <a href ng-click="enableEdit()" title="{{'edit_profile'| translate}}"><span class="bold">{{'edit'| translate}}</span></a>
        </span>
        <span class="pull-right">
            <a class="small-horizonal-spacing" href ng-click="expandCollapse(profileWidget)">
                <span ng-show="profileWidget.expand"><i class="fa fa-chevron-up" title="{{'collapse'| translate}}"></i></span>
                <span ng-show="!profileWidget.expand"><i class="fa fa-chevron-down" title="{{'expand'| translate}}"></i></span>
            </a>
            <a class="small-horizonal-spacing" href ng-click="removeWidget(profileWidget)" title="{{'remove'| translate}}"><i class="fa fa-times-circle"></i></a>            
        </span>        
    </div>
    <div ng-show="profileWidget.expand" class="panel-body dashboard-widget-container">
        <form name="outerForm" novalidate>
            
            <table class="table-borderless table-striped">
                <tr ng-repeat="attribute in selectedTei.attributes" ng-show="attribute.show">
                    <td>
                        {{attribute.displayName}}
                    </td>
                    <td>
                        <ng-form name="innerForm">
                            <div ng-switch="attribute.type">
                                <div ng-switch-when="date">
                                    <input type="text" placeholder="yyyy-mm-dd" name="foo" class="form-control" ng-date ng-model="attribute.value"  value="attribute.value | date:'yyyy-MM-dd" ng-disabled="!editProfile" ng-required="attribute.mandatory"/>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                                <div ng-switch-when="trueOnly">
                                    <input type="checkbox" name="foo" class="form-control" ng-model="attribute.value" ng-disabled="!editProfile" ng-required="attribute.mandatory"/>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                                <div ng-switch-when="bool">
                                    <select name="foo" ng-model="attribute.value" class="form-control" ng-disabled="!editProfile" ng-required="attribute.mandatory">
                                        <option value="">{{'please_select'| translate}}</option>                        
                                        <option value="0">{{'no'| translate}}</option>
                                        <option value="1">{{'yes'| translate}}</option>
                                    </select>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                                <div ng-switch-when="optionSet">
                                    <input type="text"
                                           name="foo"
                                           class="form-control"
                                           ng-model="attribute.value"                                                 
                                           typeahead="option for option in attributes[attribute.attribute].optionSet.options | filter:$viewValue | limitTo:20" 
                                           typeahead-open-on-focus 
                                           ng-disabled="!editProfile" ng-required="attribute.mandatory"/>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                                <div ng-switch-when="number">
                                    <input type="number" name="foo" class="form-control" ng-model="attribute.value" ng-disabled="!editProfile" ng-required="attribute.mandatory"/>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                                <div ng-switch-default>
                                    <input type="text" name="foo" class="form-control" ng-model="attribute.value" ng-disabled="!editProfile" ng-required="attribute.mandatory"/>
                                    <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="error">{{'required'| translate}} - {{attribute.type}}</span>
                                </div>
                            </div>
                        </ng-form>
                    </td>
                </tr>           
            </table>

            <div ng-if="editProfile" class="vertical-spacing">
                <button type="button" 
                        class="btn btn-primary small-horizonal-spacing"
                        ng-click="save()">
                    {{'save'| translate}}
                </button>        
                <button type="button" 
                        class="btn btn-default small-horizonal-spacing" 
                        ng-click="cancel()">
                    {{'cancel'| translate}}
                </button>
            </div> 
            
        </form>
    </div>
</div>