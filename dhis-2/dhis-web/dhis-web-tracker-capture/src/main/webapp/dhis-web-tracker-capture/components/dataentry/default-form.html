<form name="dataEntryOuterForm" novalidate>                
    <table class="table-borderless table-striped" ng-if='currentEvent'>
        <thead>
            <tr class="col-md-12">
                <th class="col-md-5">
                    {{'data_element'| translate}}
                </th>
                <th class="col-md-5 align-center">
                    {{'value'| translate}}
                </th>
                <th class="col-md-2 align-center" ng-if="allowProvidedElsewhereExists">
                    {{'provided_elsewhere'| translate}}
                </th>
            </tr>
        </thead>
        <tr class="col-md-12" ng-repeat="prStDe in currentStage.programStageDataElements">
            <td class="col-md-5">
                {{prStDe.dataElement.formName ? prStDe.dataElement.formName : prStDe.dataElement.name}}
            </td>
            <td class="col-md-5">
                <ng-form name="dataEntryInnerForm">
                    <div ng-switch="prStDe.dataElement.type">
                        <div ng-switch-when="int">
                            <input type="number"
                                   ng-class='getInputNotifcationClass(prStDe.dataElement.id,false)'
                                   ng-model="currentEvent[prStDe.dataElement.id]" 
                                   ng-required={{prStDe.compulsory}}
                                   ng-blur="saveDatavalue(prStDe)" 
                                   name="foo"/>
                            <span ng-show="dataEntryOuterForm.submitted && dataEntryInnerForm.foo.$invalid" class="error">{{'number_required'| translate}}</span>
                        </div>
                        <div ng-switch-when="string">    
                            <input type="text"
                                   ng-class='getInputNotifcationClass(prStDe.dataElement.id,false)'
                                   ng-model="currentEvent[prStDe.dataElement.id]" 
                                   ng-required={{prStDe.compulsory}} 
                                   typeahead="option for option in prStDe.dataElement.optionSet.options | filter:$viewValue | limitTo:20" 
                                   typeahead-open-on-focus    
                                   ng-blur="saveDatavalue(prStDe)" 
                                   name="foo"/>
                        </div>
                        <div ng-switch-when="bool">
                            <select ng-class='getInputNotifcationClass(prStDe.dataElement.id,false)'
                                    ng-model="currentEvent[prStDe.dataElement.id]" 
                                    ng-required={{prStDe.compulsory}} 
                                    ng-change="saveDatavalue(prStDe)" 
                                    name="foo">
                                <option value="">{{'please_select'| translate}}</option>                        
                                <option value="false">{{'no'| translate}}</option>
                                <option value="true">{{'yes'| translate}}</option>
                            </select>

                        </div>
                        <div ng-switch-when="date">
                            <input type="text" 
                                   placeholder="yyyy-mm-dd" 
                                   ng-date 
                                   ng-class='getInputNotifcationClass(prStDe.dataElement.id,false)'
                                   ng-model="currentEvent[prStDe.dataElement.id]"
                                   ng-required={{prStDe.compulsory}}  
                                   blur-or-change="saveDatavalue(prStDe)"
                                   name="foo"/>
                        </div>
                        <div ng-switch-when="trueOnly">
                            <input type="checkbox"                         
                                   ng-class='getInputNotifcationClass(prStDe.dataElement.id,false)'
                                   ng-model="currentEvent[prStDe.dataElement.id]"                                                               
                                   ng-required={{prStDe.compulsory}}
                                   ng-change="saveDatavalue(prStDe)" 
                                   name="foo"/>
                            <span ng-show="outerForm.submitted && innerForm.foo.$invalid" class="required">{{'required'| translate}}</span>
                        </div>
                    </div>
                </ng-form>                            
            </td>
            <td class="col-md-2" ng-if="allowProvidedElsewhereExists">                    
                <div class="align-center" ng-show="prStDe.allowProvidedElsewhere">
                    <input type="checkbox" 
                           ng-model="currentEvent.providedElsewhere[prStDe.dataElement.id]"
                           ng-change="saveDatavalueLocation(prStDe)"/>
                </div>
            </td>
        </tr>
    </table>
</form>
